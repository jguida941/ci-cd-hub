{
  "$id": "https://ci-cd-hub.dev/schema/cyclonedx-vex-1.5.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CycloneDX VEX 1.5 (subset)",
  "description": "Subset of the CycloneDX 1.5 schema that covers the fields emitted by tools/generate_vex.py.",
  "type": "object",
  "required": [
    "bomFormat",
    "specVersion",
    "serialNumber",
    "version",
    "metadata",
    "vulnerabilities"
  ],
  "properties": {
    "bomFormat": {
      "type": "string",
      "const": "CycloneDX"
    },
    "specVersion": {
      "type": "string",
      "enum": [
        "1.5"
      ]
    },
    "serialNumber": {
      "type": "string",
      "pattern": "^urn:uuid:[0-9a-fA-F-]{8}-[0-9a-fA-F-]{4}-[0-9a-fA-F-]{4}-[0-9a-fA-F-]{4}-[0-9a-fA-F-]{12}$"
    },
    "version": {
      "type": "integer",
      "minimum": 1
    },
    "metadata": {
      "$ref": "#/$defs/metadata"
    },
    "vulnerabilities": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/vulnerability"
      }
    }
  },
  "$defs": {
    "metadata": {
      "type": "object",
      "required": [
        "timestamp",
        "tools",
        "component"
      ],
      "properties": {
        "timestamp": {
          "$ref": "#/$defs/timestamp"
        },
        "tools": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/$defs/tool"
          }
        },
        "component": {
          "$ref": "#/$defs/component"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/property"
          }
        }
      },
      "additionalProperties": true
    },
    "tool": {
      "type": "object",
      "required": [
        "vendor",
        "name"
      ],
      "properties": {
        "vendor": {
          "type": "string",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string"
        }
      },
      "additionalProperties": true
    },
    "component": {
      "type": "object",
      "required": [
        "type",
        "name",
        "bom-ref"
      ],
      "properties": {
        "type": {
          "type": "string",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "manufacturer": {
          "type": "string"
        },
        "bom-ref": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": true
    },
    "property": {
      "type": "object",
      "required": [
        "name",
        "value"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "value": {
          "type": "string"
        }
      },
      "additionalProperties": true
    },
    "vulnerability": {
      "type": "object",
      "required": [
        "id",
        "analysis",
        "ratings"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "analysis": {
          "$ref": "#/$defs/analysis"
        },
        "ratings": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "detail": {
          "type": "string"
        },
        "timestamp": {
          "$ref": "#/$defs/timestamp"
        },
        "source": {
          "$ref": "#/$defs/source"
        }
      },
      "additionalProperties": true
    },
    "analysis": {
      "type": "object",
      "required": [
        "state"
      ],
      "properties": {
        "state": {
          "type": "string",
          "minLength": 1
        },
        "justification": {
          "type": "string"
        },
        "detail": {
          "type": "string"
        }
      },
      "additionalProperties": true
    },
    "source": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "url": {
          "type": "string",
          "format": "uri"
        }
      },
      "additionalProperties": true
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    }
  },
  "additionalProperties": true
}
